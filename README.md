# Getting Started
The following cosmos db terraform module provides configurable baseline service capabilities to help simplify infrastructure as code deployment and accelerate workload enablement. The module is separate into relevant subresource groupings based on cosmos db api requirements. The input variables specified for the module will provision the appropriate database/api instances. This module does not create dependent resources for certain configurations, these resources should be provision external to the module. Ex. the module will not create a key vault for customer managed key encryption, this should be created external to the module and passed in as a parameter. Please see the examples for different configurations.

Important: Please specify only the required database/api parameter for single api type. Specifying multiple (sql_api parameters and mongo_db parameters) would result in unintended errors. 

# Terraform Files and associated resources, variables and outputs
- Azure Cosmos DB Account Creation and Configurations
    - Azure Cosmos DB Account
        - main.tf and variables.tf helps create the cosmos db account and is the main portion of the module
    - Networking
        - firewall_variables.tf and locals.tf are used to aggregrated list of IPs/VNETs to whitelist within cosmos db account
        - privateendpoint.tf supports creation of multiple private endpoints and assumes that there are some network perms available to create the endpoints
    - Customer managed key 
        - cmk_data.tf and cmk_variables.tf c
    - Diagnostic settings
        - diagnostic.tf (Supports event hub, storage account and log analytics workspace targets)
- DBs by API
    - sql_api.tf and sql_variables.tf: SQL API resources 
    - mongo_api.tf and mongo_variables.tf: Mongo API resources
    - cassandra_api.tf and cassandra_variable.tf: Cassandra API resources
    - gremlin_api.tf and gremlin_variables.tf: Gremlin API resources 
    - table.tf and table_variables.tf: Table API resources 
- Outputs 
    - account_output.tf and apis_output.tf: Contains outputs for relevant 

# Feedback and suggestions
Please create a github issue for suggestions, feedback and questions.

# Contribute 
This project welcomes contributions and suggestions. Most contributions require you to agree to a Contributor License Agreement (CLA) declaring that you have the right to, and actually do, grant us the rights to use your contribution. For details, visit https://cla.microsoft.com.

When you submit a pull request, a CLA-bot will automatically determine whether you need to provide a CLA and decorate the PR appropriately (e.g., label, comment). Simply follow the instructions provided by the bot. You will only need to do this once across all repos using our CLA.

This project has adopted the Microsoft Open Source Code of Conduct. For more information see the Code of Conduct FAQ or contact opencode@microsoft.com with any additional questions or comments.


<!-- BEGIN_TF_DOCS -->
## Requirements

| Name                                                                      | Version |
|---------------------------------------------------------------------------|---------|
| <a name="requirement_terraform"></a> [terraform](#requirement\_terraform) | >= 1.2  |
| <a name="requirement_azapi"></a> [azapi](#requirement\_azapi)             | >=1.0.0 |
| <a name="requirement_azurerm"></a> [azurerm](#requirement\_azurerm)       | >=3.0   |

## Providers

| Name                                                          | Version |
|---------------------------------------------------------------|---------|
| <a name="provider_azurerm"></a> [azurerm](#provider\_azurerm) | >=3.0   |
| <a name="provider_random"></a> [random](#provider\_random)    | n/a     |

## Modules

No modules.

## Resources

| Name                                                                                                                                                       | Type        |
|------------------------------------------------------------------------------------------------------------------------------------------------------------|-------------|
| [azurerm_cosmosdb_account.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/cosmosdb_account)                          | resource    |
| [azurerm_cosmosdb_cassandra_keyspace.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/cosmosdb_cassandra_keyspace)    | resource    |
| [azurerm_cosmosdb_cassandra_table.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/cosmosdb_cassandra_table)          | resource    |
| [azurerm_cosmosdb_gremlin_database.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/cosmosdb_gremlin_database)        | resource    |
| [azurerm_cosmosdb_gremlin_graph.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/cosmosdb_gremlin_graph)              | resource    |
| [azurerm_cosmosdb_mongo_collection.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/cosmosdb_mongo_collection)        | resource    |
| [azurerm_cosmosdb_mongo_database.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/cosmosdb_mongo_database)            | resource    |
| [azurerm_cosmosdb_sql_container.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/cosmosdb_sql_container)              | resource    |
| [azurerm_cosmosdb_sql_database.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/cosmosdb_sql_database)                | resource    |
| [azurerm_cosmosdb_table.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/cosmosdb_table)                              | resource    |
| [azurerm_monitor_diagnostic_setting.eh](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/monitor_diagnostic_setting)        | resource    |
| [azurerm_monitor_diagnostic_setting.la](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/monitor_diagnostic_setting)        | resource    |
| [azurerm_monitor_diagnostic_setting.sa](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/monitor_diagnostic_setting)        | resource    |
| [azurerm_private_endpoint.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/private_endpoint)                          | resource    |
| [random_integer.this](https://registry.terraform.io/providers/hashicorp/random/latest/docs/resources/integer)                                              | resource    |
| [azurerm_client_config.current](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/data-sources/client_config)                          | data source |
| [azurerm_eventhub_authorization_rule.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/data-sources/eventhub_authorization_rule) | data source |
| [azurerm_key_vault.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/data-sources/key_vault)                                     | data source |
| [azurerm_key_vault_key.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/data-sources/key_vault_key)                             | data source |
| [azurerm_log_analytics_workspace.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/data-sources/log_analytics_workspace)         | data source |
| [azurerm_private_dns_zone.pe_private_dns_zone](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/data-sources/private_dns_zone)        | data source |
| [azurerm_resource_group.pe_vnet_rg](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/data-sources/resource_group)                     | data source |
| [azurerm_resource_group.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/data-sources/resource_group)                           | data source |
| [azurerm_storage_account.this](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/data-sources/storage_account)                         | data source |
| [azurerm_subnet.pe_subnet](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/data-sources/subnet)                                      | data source |

## Inputs

| Name                                                                                                                             | Description                                                                                                                                                                                                              | Type                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | Default                                                                                                                                                                                                                                                                                     | Required |
|----------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:--------:|
| <a name="input_additional_capabilities"></a> [additional\_capabilities](#input\_additional\_capabilities)                        | List of additional capabilities for Cosmos DB API. - possible options are DisableRateLimitingResponses, EnableAggregationPipeline, EnableServerless, mongoEnableDocLevelTTL, MongoDBv3.4, AllowSelfServeUpgradeToMongo36 | `list(string)`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | `[]`                                                                                                                                                                                                                                                                                        |    no    |
| <a name="input_analytical_storage"></a> [analytical\_storage](#input\_analytical\_storage)                                       | Analytical storage enablement.                                                                                                                                                                                           | <pre>object({<br>    enabled     = bool<br>    schema_type = string<br>  })</pre>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              | <pre>{<br>  "enabled": false,<br>  "schema_type": null<br>}</pre>                                                                                                                                                                                                                           |    no    |
| <a name="input_application_name"></a> [application\_name](#input\_application\_name)                                             | Name of the application.                                                                                                                                                                                                 | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `"dev"`                                                                                                                                                                                                                                                                                     |    no    |
| <a name="input_auto_failover"></a> [auto\_failover](#input\_auto\_failover)                                                      | Enable automatic fail over for this Cosmos DB account - can be either true or false                                                                                                                                      | `bool`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `false`                                                                                                                                                                                                                                                                                     |    no    |
| <a name="input_azure_dc_access"></a> [azure\_dc\_access](#input\_azure\_dc\_access)                                              | List of ip address to enable the Accept connections from within public Azure datacenters behavior.                                                                                                                       | `list(string)`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | <pre>[<br>  "0.0.0.0"<br>]</pre>                                                                                                                                                                                                                                                            |    no    |
| <a name="input_azure_portal_access"></a> [azure\_portal\_access](#input\_azure\_portal\_access)                                  | List of ip address to enable the Allow access from the Azure portal behavior.                                                                                                                                            | `list(string)`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | <pre>[<br>  "104.42.195.92,40.76.54.131,52.176.6.30,52.169.50.45,52.187.184.26"<br>]</pre>                                                                                                                                                                                                  |    no    |
| <a name="input_backup_enabled"></a> [backup\_enabled](#input\_backup\_enabled)                                                   | Enable backup for this Cosmos DB account                                                                                                                                                                                 | `bool`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `true`                                                                                                                                                                                                                                                                                      |    no    |
| <a name="input_backup_interval"></a> [backup\_interval](#input\_backup\_interval)                                                | The interval in minutes between two backups. This is configurable only when type is Periodic. Possible values are between 60 and 1440.                                                                                   | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `60`                                                                                                                                                                                                                                                                                        |    no    |
| <a name="input_backup_retention"></a> [backup\_retention](#input\_backup\_retention)                                             | The time in hours that each backup is retained. This is configurable only when type is Periodic. Possible values are between 8 and 720.                                                                                  | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `8`                                                                                                                                                                                                                                                                                         |    no    |
| <a name="input_backup_storage_redundancy"></a> [backup\_storage\_redundancy](#input\_backup\_storage\_redundancy)                | he storage redundancy which is used to indicate type of backup residency. This is configurable only when type is Periodic. Possible values are Geo, Local and Zone                                                       | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `"Geo"`                                                                                                                                                                                                                                                                                     |    no    |
| <a name="input_backup_type"></a> [backup\_type](#input\_backup\_type)                                                            | Type of backup - can be either Periodic or Continuous                                                                                                                                                                    | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `"periodic"`                                                                                                                                                                                                                                                                                |    no    |
| <a name="input_capabilities"></a> [capabilities](#input\_capabilities)                                                           | Map of non-sql DB API to enable support for API other than SQL                                                                                                                                                           | `map(any)`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | <pre>{<br>  "cassandra": "EnableCassandra",<br>  "gremlin": "EnableGremlin",<br>  "mongo": "EnableMongo",<br>  "sql": "SQL",<br>  "table": "EnableTable"<br>}</pre>                                                                                                                         |    no    |
| <a name="input_cassandra_keyspaces"></a> [cassandra\_keyspaces](#input\_cassandra\_keyspaces)                                    | List of Cosmos DB Cassandra keyspaces to create. Some parameters are inherited from cosmos account.                                                                                                                      | <pre>map(object({<br>    keyspace_name           = string<br>    keyspace_throughput     = number<br>    keyspace_max_throughput = number<br>  }))</pre>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `{}`                                                                                                                                                                                                                                                                                        |    no    |
| <a name="input_cassandra_tables"></a> [cassandra\_tables](#input\_cassandra\_tables)                                             | List of Cosmos DB Cassandra tables to create. Some parameters are inherited from cosmos account.                                                                                                                         | <pre>map(object({<br>    table_name             = string<br>    keyspace_name          = string<br>    default_ttl_seconds    = string<br>    analytical_storage_ttl = number<br>    table_throughout       = number<br>    table_max_throughput   = number<br>    cassandra_schema_settings = object({<br>      column = map(object({<br>        column_key_name = string<br>        column_key_type = string<br>      }))<br>      partition_key = map(object({<br>        partition_key_name = string<br>      }))<br>      cluster_key = map(object({<br>        cluster_key_name     = string<br>        cluster_key_order_by = string<br>      }))<br>    })<br>  }))</pre>                                                                                                                                                                                                                                                                                              | `{}`                                                                                                                                                                                                                                                                                        |    no    |
| <a name="input_consistency_level"></a> [consistency\_level](#input\_consistency\_level)                                          | The Consistency Level to use for this CosmosDB Account - can be either BoundedStaleness, Eventual, Session, Strong or ConsistentPrefix                                                                                   | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `"Eventual"`                                                                                                                                                                                                                                                                                |    no    |
| <a name="input_cosmos_account_name"></a> [cosmos\_account\_name](#input\_cosmos\_account\_name)                                  | Name of the Cosmos DB account.                                                                                                                                                                                           | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `""`                                                                                                                                                                                                                                                                                        |    no    |
| <a name="input_cosmos_api"></a> [cosmos\_api](#input\_cosmos\_api)                                                               | n/a                                                                                                                                                                                                                      | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | n/a                                                                                                                                                                                                                                                                                         |   yes    |
| <a name="input_enable_systemassigned_identity"></a> [enable\_systemassigned\_identity](#input\_enable\_systemassigned\_identity) | Enable System Assigned Identity                                                                                                                                                                                          | `bool`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `false`                                                                                                                                                                                                                                                                                     |    no    |
| <a name="input_environment"></a> [environment](#input\_environment)                                                              | Name of the environment. Example dev, test, qa, cert, prod etc....                                                                                                                                                       | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `"dev"`                                                                                                                                                                                                                                                                                     |    no    |
| <a name="input_event_hub"></a> [event\_hub](#input\_event\_hub)                                                                  | Event Hub parameters for one or more event hub to send daignostic logs to event hub.                                                                                                                                     | <pre>map(object({<br>    event_hub_name           = string<br>    event_hub_namespace_name = string<br>    event_hub_rg_name        = string<br>    event_hub_auth_rule_name = string<br>  }))</pre>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           | `{}`                                                                                                                                                                                                                                                                                        |    no    |
| <a name="input_firewall_ip"></a> [firewall\_ip](#input\_firewall\_ip)                                                            | List of ip address to allow access from the internet or on-premisis network.                                                                                                                                             | `list(string)`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 | `[]`                                                                                                                                                                                                                                                                                        |    no    |
| <a name="input_free_tier"></a> [free\_tier](#input\_free\_tier)                                                                  | Enable Free Tier pricing option for this Cosmos DB account - can be either true or false                                                                                                                                 | `bool`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `false`                                                                                                                                                                                                                                                                                     |    no    |
| <a name="input_geo_locations"></a> [geo\_locations](#input\_geo\_locations)                                                      | List of map of geo locations and other properties to create primary and secodanry databasees.                                                                                                                            | <pre>list(object({<br>    geo_location      = string<br>    failover_priority = number<br>    zone_redundant    = bool<br>  }))</pre>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          | <pre>[<br>  {<br>    "failover_priority": 0,<br>    "geo_location": "eastus",<br>    "zone_redundant": false<br>  }<br>]</pre>                                                                                                                                                              |    no    |
| <a name="input_gremlin_dbs"></a> [gremlin\_dbs](#input\_gremlin\_dbs)                                                            | Map of Cosmos DB Gremlin DBs to create. Some parameters are inherited from cosmos account.                                                                                                                               | <pre>map(object({<br>    db_name           = string<br>    db_throughput     = number<br>    db_max_throughput = number<br>  }))</pre>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `{}`                                                                                                                                                                                                                                                                                        |    no    |
| <a name="input_gremlin_graphs"></a> [gremlin\_graphs](#input\_gremlin\_graphs)                                                   | List of Cosmos DB Gremlin Graph to create. Some parameters are inherited from cosmos account.                                                                                                                            | <pre>map(object({<br>    graph_name            = string<br>    db_name               = string<br>    partition_key_path    = string<br>    partition_key_version = number<br>    default_ttl_seconds   = string<br>    graph_throughput      = number<br>    graph_max_throughput  = number<br>    index_policy_settings = object({<br>      indexing_automatic = bool<br>      indexing_mode      = string<br>      included_paths     = list(string)<br>      excluded_paths     = list(string)<br>      composite_indexes = map(object({<br>        indexes = set(object({<br>          index_path  = string<br>          index_order = string<br>        }))<br>      }))<br>      spatial_indexes = map(object({<br>        spatial_index_path = string<br>      }))<br>    })<br>    conflict_resolution_policy = object({<br>      mode      = string<br>      path      = string<br>      procedure = string<br>    })<br>    unique_key = list(string)<br>  }))</pre> | `{}`                                                                                                                                                                                                                                                                                        |    no    |
| <a name="input_ip_firewall_enabled"></a> [ip\_firewall\_enabled](#input\_ip\_firewall\_enabled)                                  | Enable ip firewwall to allow connection to this cosmosdb from client's machine and from azure portal.                                                                                                                    | `bool`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `true`                                                                                                                                                                                                                                                                                      |    no    |
| <a name="input_key_vault_key_name"></a> [key\_vault\_key\_name](#input\_key\_vault\_key\_name)                                   | Name of the existing key in key vault. It is needed for encryption using customer managed key.                                                                                                                           | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `""`                                                                                                                                                                                                                                                                                        |    no    |
| <a name="input_key_vault_name"></a> [key\_vault\_name](#input\_key\_vault\_name)                                                 | Name of the existing key vault. It is needed for encryption using customer managed key.                                                                                                                                  | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `""`                                                                                                                                                                                                                                                                                        |    no    |
| <a name="input_key_vault_rg_name"></a> [key\_vault\_rg\_name](#input\_key\_vault\_rg\_name)                                      | Name of the resource group in which key vault exists.                                                                                                                                                                    | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `""`                                                                                                                                                                                                                                                                                        |    no    |
| <a name="input_location"></a> [location](#input\_location)                                                                       | Cosmos DB deployment region. Can be different vs. RG location                                                                                                                                                            | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `""`                                                                                                                                                                                                                                                                                        |    no    |
| <a name="input_log_analytics"></a> [log\_analytics](#input\_log\_analytics)                                                      | Log Analytics parameters for one or more log analytics workspace to send daignostic logs to log analytics workspace.                                                                                                     | <pre>map(object({<br>    la_workspace_name    = string<br>    la_workspace_rg_name = string<br>  }))</pre>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | `{}`                                                                                                                                                                                                                                                                                        |    no    |
| <a name="input_logs_config"></a> [logs\_config](#input\_logs\_config)                                                            | Map of non-sql DB API logs configuration to enable logging for respective API                                                                                                                                            | `map(any)`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | <pre>{<br>  "cassandra": "CassandraRequests",<br>  "gremlin": "GremlinRequests",<br>  "mongo": "MongoRequests",<br>  "sql": "SQL",<br>  "table": "TableApiRequests"<br>}</pre>                                                                                                              |    no    |
| <a name="input_max_interval_in_seconds"></a> [max\_interval\_in\_seconds](#input\_max\_interval\_in\_seconds)                    | When used with the Bounded Staleness consistency level, this value represents the time amount of staleness (in seconds) tolerated. Accepted range for this value is 5 - 86400 (1 day)                                    | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `300`                                                                                                                                                                                                                                                                                       |    no    |
| <a name="input_max_staleness_prefix"></a> [max\_staleness\_prefix](#input\_max\_staleness\_prefix)                               | When used with the Bounded Staleness consistency level, this value represents the number of stale requests tolerated. Accepted range for this value is 10 – 2147483647                                                   | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | `100000`                                                                                                                                                                                                                                                                                    |    no    |
| <a name="input_mongo_db_collections"></a> [mongo\_db\_collections](#input\_mongo\_db\_collections)                               | List of Cosmos DB Mongo collections to create. Some parameters are inherited from cosmos account.                                                                                                                        | <pre>map(object({<br>    collection_name           = string<br>    db_name                   = string<br>    default_ttl_seconds       = string<br>    shard_key                 = string<br>    collection_throughout     = number<br>    collection_max_throughput = number<br>    analytical_storage_ttl    = number<br>    indexes = map(object({<br>      mongo_index_keys   = list(string)<br>      mongo_index_unique = bool<br>    }))<br>  }))</pre>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  | `{}`                                                                                                                                                                                                                                                                                        |    no    |
| <a name="input_mongo_dbs"></a> [mongo\_dbs](#input\_mongo\_dbs)                                                                  | Map of Cosmos DB Mongo DBs to create. Some parameters are inherited from cosmos account.                                                                                                                                 | <pre>map(object({<br>    db_name           = string<br>    db_throughput     = number<br>    db_max_throughput = number<br>  }))</pre>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `{}`                                                                                                                                                                                                                                                                                        |    no    |
| <a name="input_multi_region_write"></a> [multi\_region\_write](#input\_multi\_region\_write)                                     | Enable multiple write locations for this Cosmos DB account                                                                                                                                                               | `bool`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `false`                                                                                                                                                                                                                                                                                     |    no    |
| <a name="input_pe_subresource"></a> [pe\_subresource](#input\_pe\_subresource)                                                   | Map of subresources to choose appropriate Private Endpoint sub resource for DB API                                                                                                                                       | `map(any)`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | <pre>{<br>  "cassandra": "Cassandra",<br>  "gremlin": "Gremlin",<br>  "mongo": "MongoDB",<br>  "sql": "SQL",<br>  "table": "Table"<br>}</pre>                                                                                                                                               |    no    |
| <a name="input_private_dns_zone_name"></a> [private\_dns\_zone\_name](#input\_private\_dns\_zone\_name)                          | Map of the private DNS zone to choose approrite Private DNS Zone for DB API.                                                                                                                                             | `map(any)`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     | <pre>{<br>  "cassandra": "privatelink.cassandra.cosmos.azure.com",<br>  "gremlin": "privatelink.gremlin.cosmos.azure.com",<br>  "mongo": "privatelink.mongo.cosmos.azure.com",<br>  "sql": "privatelink.documents.azure.com",<br>  "table": "privatelink.table.cosmos.azure.com"<br>}</pre> |    no    |
| <a name="input_private_endpoint"></a> [private\_endpoint](#input\_private\_endpoint)                                             | Parameters for private endpoint creation                                                                                                                                                                                 | <pre>map(object({<br>    name                            = string<br>    vnet_rg_name                    = string<br>    vnet_name                       = string<br>    subnet_name                     = string<br>    dns_zone_rg_name                = string<br>    enable_private_dns_entry        = bool<br>    dns_zone_group_name             = string<br>    private_service_connection_name = string<br>    is_manual_connection            = bool<br>  }))</pre>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   | `{}`                                                                                                                                                                                                                                                                                        |    no    |
| <a name="input_public_network_access_enabled"></a> [public\_network\_access\_enabled](#input\_public\_network\_access\_enabled)  | Enable public network access to cosmos db                                                                                                                                                                                | `bool`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `false`                                                                                                                                                                                                                                                                                     |    no    |
| <a name="input_resource_group_name"></a> [resource\_group\_name](#input\_resource\_group\_name)                                  | Name of the azure resource group.                                                                                                                                                                                        | `string`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       | n/a                                                                                                                                                                                                                                                                                         |   yes    |
| <a name="input_sql_db_containers"></a> [sql\_db\_containers](#input\_sql\_db\_containers)                                        | List of Cosmos DB SQL Containers to create. Some parameters are inherited from cosmos account.                                                                                                                           | <pre>map(object({<br>    container_name           = string<br>    db_name                  = string<br>    partition_key_path       = string<br>    partition_key_version    = number<br>    container_throughout     = number<br>    container_max_throughput = number<br>    default_ttl              = number<br>    analytical_storage_ttl   = number<br>    indexing_policy_settings = object({<br>      sql_indexing_mode = string<br>      sql_included_path = string<br>      sql_excluded_path = string<br>      composite_indexes = map(object({<br>        indexes = set(object({<br>          path  = string<br>          order = string<br>        }))<br>      }))<br>      spatial_indexes = map(object({<br>        path = string<br>      }))<br>    })<br>    sql_unique_key = list(string)<br>    conflict_resolution_policy = object({<br>      mode      = string<br>      path      = string<br>      procedure = string<br>    })<br>  }))</pre>        | `{}`                                                                                                                                                                                                                                                                                        |    no    |
| <a name="input_sql_dbs"></a> [sql\_dbs](#input\_sql\_dbs)                                                                        | Map of Cosmos DB SQL DBs to create. Some parameters are inherited from cosmos account.                                                                                                                                   | <pre>map(object({<br>    db_name           = string<br>    db_throughput     = number<br>    db_max_throughput = number<br>  }))</pre>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         | `{}`                                                                                                                                                                                                                                                                                        |    no    |
| <a name="input_storage_account"></a> [storage\_account](#input\_storage\_account)                                                | Storage account parameters for one or more storage account to send daignostic logs to storage account.                                                                                                                   | <pre>map(object({<br>    storage_account_name         = string<br>    storage_account_rg_name      = string<br>    enable_logs_retention_policy = bool<br>    logs_retention_days          = number<br>  }))</pre>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             | `{}`                                                                                                                                                                                                                                                                                        |    no    |
| <a name="input_tables"></a> [tables](#input\_tables)                                                                             | Map of Cosmos DB Tables to create. Some parameters are inherited from cosmos account.                                                                                                                                    | <pre>map(object({<br>    table_name           = string<br>    table_throughput     = number<br>    table_max_throughput = number<br>  }))</pre>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | `{}`                                                                                                                                                                                                                                                                                        |    no    |

## Outputs

| Name                                                                                                                                     | Description                                                     |
|------------------------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------------|
| <a name="output_cassandra_keyspace_id"></a> [cassandra\_keyspace\_id](#output\_cassandra\_keyspace\_id)                                  | Cassandra API Keyspace IDs                                      |
| <a name="output_cassandra_table_id"></a> [cassandra\_table\_id](#output\_cassandra\_table\_id)                                           | Cassandra API Table IDs                                         |
| <a name="output_cosmosdb_connection_strings"></a> [cosmosdb\_connection\_strings](#output\_cosmosdb\_connection\_strings)                | Cosmos DB Connection Strings                                    |
| <a name="output_cosmosdb_endpoint"></a> [cosmosdb\_endpoint](#output\_cosmosdb\_endpoint)                                                | Cosmos DB Endpoint                                              |
| <a name="output_cosmosdb_id"></a> [cosmosdb\_id](#output\_cosmosdb\_id)                                                                  | Cosmos DB Account ID                                            |
| <a name="output_cosmosdb_primary_key"></a> [cosmosdb\_primary\_key](#output\_cosmosdb\_primary\_key)                                     | Cosmos DB Primary Keys                                          |
| <a name="output_cosmosdb_primary_readonly_key"></a> [cosmosdb\_primary\_readonly\_key](#output\_cosmosdb\_primary\_readonly\_key)        | Cosmos DB Primary Read Only Keys                                |
| <a name="output_cosmosdb_read_endpoint"></a> [cosmosdb\_read\_endpoint](#output\_cosmosdb\_read\_endpoint)                               | Cosmos DB Read Endpoint                                         |
| <a name="output_cosmosdb_secondary_key"></a> [cosmosdb\_secondary\_key](#output\_cosmosdb\_secondary\_key)                               | Cosmos DB Secondary Keys                                        |
| <a name="output_cosmosdb_secondary_readonly_key"></a> [cosmosdb\_secondary\_readonly\_key](#output\_cosmosdb\_secondary\_readonly\_key)  | Cosmos DB Secondary Read Only Keys                              |
| <a name="output_cosmosdb_systemassigned_identity"></a> [cosmosdb\_systemassigned\_identity](#output\_cosmosdb\_systemassigned\_identity) | Cosmos DB System Assigned Identity (Tenant ID and Principal ID) |
| <a name="output_cosmosdb_write_endpoint"></a> [cosmosdb\_write\_endpoint](#output\_cosmosdb\_write\_endpoint)                            | Cosmos DB Write Endpoint                                        |
| <a name="output_gremlin_db_id"></a> [gremlin\_db\_id](#output\_gremlin\_db\_id)                                                          | Gremlin API DB IDs                                              |
| <a name="output_gremlin_graph_id"></a> [gremlin\_graph\_id](#output\_gremlin\_graph\_id)                                                 | Gremlin API Graph IDs                                           |
| <a name="output_mongo_db_collection_id"></a> [mongo\_db\_collection\_id](#output\_mongo\_db\_collection\_id)                             | Mongo API Collection IDs                                        |
| <a name="output_mongo_db_id"></a> [mongo\_db\_id](#output\_mongo\_db\_id)                                                                | Mongo API DB IDs                                                |
| <a name="output_sql_containers_id"></a> [sql\_containers\_id](#output\_sql\_containers\_id)                                              | SQL API Container IDs                                           |
| <a name="output_sql_db_id"></a> [sql\_db\_id](#output\_sql\_db\_id)                                                                      | SQL API DB IDs                                                  |
| <a name="output_table_id"></a> [table\_id](#output\_table\_id)                                                                           | Table API Table IDs                                             |
<!-- END_TF_DOCS -->